I"Á€<p><a href="https://developer.apple.com/tutorials/app-dev-training/decoding-structured-json">Earthquakes app tutorial</a></p>
<blockquote>
  <p>ì´ ê¸€ì€ ìœ„ì˜ apple developer tutorialì„ ë”°ë¼ê°€ë©° ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
</blockquote>

<h1 id="error">Error</h1>
<blockquote>
  <p>/decoding-structured-json/Decode earthquake data/step 8</p>
</blockquote>

<p>Swiftì—ì„œëŠ” Error í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” íƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br />
  Error í”„ë¡œí† ì½œì€ ì—ëŸ¬ë¥¼ í•¸ë“¤ë§í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” íƒ€ì…ì´ë¼ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¼ ë¿ ì•„ë¬´ëŸ° ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.<br />
  ìš”êµ¬ì‚¬í•­ë„ ì—†ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì»¤ìŠ¤í…€ íƒ€ì…ì— ììœ ë¡­ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">enum</span> <span class="kt">QuakeError</span><span class="p">:</span> <span class="kt">Error</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">missingData</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">QuakeError</span><span class="p">:</span> <span class="kt">LocalizedError</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">errorDescription</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="k">self</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">missingData</span><span class="p">:</span>
            <span class="k">return</span> <span class="kt">NSLocalizedString</span><span class="p">(</span><span class="s">"Found and will discard a quake missing a valid code, magnitude, place, or time."</span><span class="p">,</span> <span class="nv">comment</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ìœ„ QuakeError enumerationì€ case missingDataë¥¼ ê°€ì§€ëŠ”ë° LocalizedError í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” extensionì„ ì‘ì„±í•˜ì—¬, QuakeError.missingDataë¡œ ì—ëŸ¬ê°€ ë˜ì ¸ì§ˆ ê²½ìš° â€œcode, maginitude, place, time ì¤‘ ì—†ëŠ” ë°ì´í„°ê°€ ìˆì–´ ì •ìƒì ìœ¼ë¡œ ì½”ë“œê°€ ì‘ë™í•˜ì§€ ì•Šì•˜ë‹¤â€ëŠ” ë©”ì„¸ì§€ë¥¼ í‘œì¶œí•  ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Quake structë¼ëŠ” ì„¤ê³„ë„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë””ì½”ë”©í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ from decoder:_ë¥¼ ì¸ìë¡œ ê°€ì§€ëŠ” init ì‚¬ìš©</span>
<span class="c1">// throws function, try, try?ë¥¼ ì‚¬ìš©í•˜ì—¬ ë””ì½”ë”© ê³¼ì • ì¤‘ ì—ëŸ¬ ë°œìƒ ì‹œ nilì„ ë°˜í™˜í•˜ë„ë¡ ì²˜ë¦¬í•¨</span>
<span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">values</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawMagnitude</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">magitude</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawPlace</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">place</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawTime</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Date</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">time</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawCode</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">code</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawDetail</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">URL</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">detail</span><span class="p">)</span>
    
    <span class="c1">// try? ê°€ ì‚¬ìš©ëœ ê³³ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜µì…”ë„ ê°’ì´ ë°˜í™˜ë˜ë¯€ë¡œ í•´ë‹¹ ê°’ì„ unwrapping í•¨</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">magnitude</span> <span class="o">=</span> <span class="n">rawMagnitude</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">place</span> <span class="o">=</span> <span class="n">rawPlace</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">time</span> <span class="o">=</span> <span class="n">rawTime</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">code</span> <span class="o">=</span> <span class="n">rawCode</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">detail</span> <span class="o">=</span> <span class="n">rawDetail</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="kt">QuakeError</span><span class="o">.</span><span class="n">missingData</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>ìœ„ ì˜ˆì‹œì˜ ê°€ì¥ ì•„ë˜ìª½ì— ìˆëŠ” else êµ¬ë¬¸ì—ì„œ throw í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ ë˜ì¡ŒìŠµë‹ˆë‹¤. magnitude, place, time, code, detail ì¤‘ ë°ì´í„°ê°€ ì—†ëŠ” ê²ƒì´ ìˆì„ ë•Œ QuakeError.missingData ì—ëŸ¬ê°€ ë˜ì ¸ì§‘ë‹ˆë‹¤.</p>

<h1 id="experiment">Experiment</h1>
<blockquote>
  <p>/decoding-structured-json/Decoding structured JSON/test the decoder</p>
</blockquote>

<ul>
  <li>ì“°ë‚˜ë¯¸ ê²½ë³´ë¥¼ í‘¸ì‹œ ì•Œë¦¼ìœ¼ë¡œ ë³´ë‚´ë ¤ í•˜ëŠ” ìƒí™©</li>
  <li>
    <p>íŠœí† ë¦¬ì–¼ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ì“°ë‚˜ë¯¸ ê´€ë ¨ ë°ì´í„°ë¥¼ ë””ì½”ë”©í•´ë³´ê¸°</p>
  </li>
  <li>USGS ì‚¬ì´íŠ¸ì—ì„œ ì“°ë‚˜ë¯¸ì˜ ë°ì´í„° íƒ€ì…ì„ ì°¾ìŒ -&gt; Integer</li>
  <li>Quake ìŠ¤íŠ¸ëŸ­ì²˜ì— tsunami í”„ë¡œí¼í‹° ì¶”ê°€</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Quake</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    
    <span class="k">let</span> <span class="nv">magnitude</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">let</span> <span class="nv">place</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">time</span><span class="p">:</span> <span class="kt">Date</span>
    <span class="k">let</span> <span class="nv">code</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">detail</span><span class="p">:</span> <span class="kt">URL</span>
    <span class="k">let</span> <span class="nv">tsunami</span><span class="p">:</span> <span class="kt">Int</span>
    
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>í‚¤ ê°’ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” CodingKeys enumì— tsunamiì¼ ê²½ìš°ë¥¼ ì¶”ê°€</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">magnitude</span> <span class="o">=</span> <span class="s">"mag"</span>
    <span class="k">case</span> <span class="n">place</span>
    <span class="k">case</span> <span class="n">time</span>
    <span class="k">case</span> <span class="n">code</span>
    <span class="k">case</span> <span class="n">detail</span>
    <span class="k">case</span> <span class="n">tsunami</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>ìƒì„±ìì— í•„ìš”í•œ ì½”ë“œ ì¶”ê°€</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">values</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawMagnitude</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">magitude</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawPlace</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">place</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawTime</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Date</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">time</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawCode</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">code</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawDetail</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">URL</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">detail</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">rawTsunami</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">tsunami</span><span class="p">)</span>
    
    <span class="c1">// try? ê°€ ì‚¬ìš©ëœ ê³³ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì˜µì…”ë„ ê°’ì´ ë°˜í™˜ë˜ë¯€ë¡œ í•´ë‹¹ ê°’ì„ unwrapping í•¨</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">magnitude</span> <span class="o">=</span> <span class="n">rawMagnitude</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">place</span> <span class="o">=</span> <span class="n">rawPlace</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">time</span> <span class="o">=</span> <span class="n">rawTime</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">code</span> <span class="o">=</span> <span class="n">rawCode</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">detail</span> <span class="o">=</span> <span class="n">rawDetail</span><span class="p">,</span>
          <span class="k">let</span> <span class="nv">tsunami</span> <span class="o">=</span> <span class="n">rawTsunami</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="kt">QuakeError</span><span class="o">.</span><span class="n">missingData</span>
    <span class="p">}</span>
    
    <span class="k">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">=</span> <span class="n">magnitude</span>
    <span class="k">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>
    <span class="k">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span>
    <span class="k">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
    <span class="k">self</span><span class="o">.</span><span class="n">detail</span> <span class="o">=</span> <span class="n">detail</span>
    <span class="k">self</span><span class="o">.</span><span class="n">tsunami</span> <span class="o">=</span> <span class="n">tsunami</span>
    
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>í˜„ì¬ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ê°’ì¸ 0ê³¼ ê°™ì€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ í™•ì¸</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">XCTest</span>
<span class="kd">@testable</span> <span class="kd">import</span> <span class="kt">FollwingEarthquake</span>

<span class="kd">class</span> <span class="kt">FollwingEarthquakeTests</span><span class="p">:</span> <span class="kt">XCTestCase</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="nf">testGeoJSONDecoderDecodesQuake</span><span class="p">()</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">decoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
        <span class="n">decoder</span><span class="o">.</span><span class="n">dateDecodingStrategy</span> <span class="o">=</span> <span class="o">.</span><span class="n">millisecondsSince1970</span>
        <span class="k">let</span> <span class="nv">quake</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Quake</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">testFeature_nc73649170</span><span class="p">)</span>
        
        <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="n">quake</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="s">"73649170"</span><span class="p">)</span>
        
        
        <span class="k">let</span> <span class="nv">expectedSeconds</span> <span class="o">=</span> <span class="kt">TimeInterval</span><span class="p">(</span><span class="mi">1636129710550</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>
        <span class="k">let</span> <span class="nv">decodedSeconds</span> <span class="o">=</span> <span class="n">quake</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">timeIntervalSince1970</span>
        
        <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="n">expectedSeconds</span><span class="p">,</span> <span class="n">decodedSeconds</span><span class="p">,</span> <span class="nv">accuracy</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">)</span>
        
        
        <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="n">quake</span><span class="o">.</span><span class="n">tsunami</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// í…ŒìŠ¤íŠ¸ í†µê³¼</span>
        
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="privateset">private(set)</h1>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">GeoJSON</span> <span class="p">{</span>
    <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">quakes</span><span class="p">:[</span><span class="kt">Quake</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>private(set) modifierê°€ ì‚¬ìš©ëœ ë°°ì—´ quakesëŠ” GeoJSON ìŠ¤íŠ¸ëŸ­ì³ ì•ˆì—ìˆëŠ” ì½”ë“œì—ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.<br />
  GeoJSON ìŠ¤íŠ¸ëŸ­ì²˜ ë°”ê¹¥ì—ì„œ ì‘ì„±ëœ ì½”ë“œì—ì„œëŠ” quakesì˜ ê°’ì„ ì½ëŠ” ê²ƒë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>

<h1 id="structuredjson">structuredJSON</h1>

<center><img src="/assets/images/structuredJSON.jpg" alt="structuredJSON.jpg" width="550" /></center>
<p><br /></p>

<p>USGSì˜ ì§€ì§„ ì •ë³´ëŠ” structuredJSON í˜•íƒœë¡œ ì œê³µë©ë‹ˆë‹¤. í•„ìš”í•œ ì •ë³´ì¸ latitude / longitudeë¥¼ ì–»ê¸° ìœ„í•´ 
ê° structureë¥¼ ì •ì˜í•©ë‹ˆë‹¤. Products íƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ RootProperties íƒ€ì… ì•ˆì— productsë¥¼ ì •ì˜í•˜ê³ <br />
Origin íƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ Products íƒ€ì… ì•ˆì— origin ì„ ì •ì˜í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì´ë¯¸ì§€ ì† GeoJSON ê³„ì¸µì„<br />
ëª¨ë¸ë§í•©ë‹ˆë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">latitude</span><span class="p">:</span> <span class="kt">Double</span> <span class="p">{</span> <span class="n">properties</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">first</span><span class="o">!.</span><span class="n">properties</span><span class="o">.</span><span class="n">latitude</span> <span class="p">}</span>
<span class="k">var</span> <span class="nv">longitude</span><span class="p">:</span> <span class="kt">Double</span> <span class="p">{</span> <span class="n">properties</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">first</span><span class="o">!.</span><span class="n">properties</span><span class="o">.</span><span class="n">longitude</span> <span class="p">}</span>
</code></pre></div></div>
<p>ëª¨ë¸ë§í•œ ìŠ¤íŠ¸ëŸ­ì²˜ë¥¼ ì´ìš©í•˜ì—¬ ìœ„ì™€ ê°™ì´ latitude, longitude ì •ë³´ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ë£¨íŠ¸ í”„ë¡œí¼í‹°ë¡œë¶€í„° í•œ ê³„ì¸µì”© ë‚´ë ¤ê°€ë©° 
ìµœì¢…ì ìœ¼ë¡œ latitudeì™€ longitudeë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ì‹ì´ ì¸ìƒê¹Šì—ˆìŠµë‹ˆë‹¤.</p>

<h1 id="codingkey-enum">CodingKey enum</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">magnitude</span> <span class="o">=</span> <span class="s">"mag"</span>
    <span class="k">case</span> <span class="n">place</span>
    <span class="k">case</span> <span class="n">time</span>
    <span class="k">case</span> <span class="n">code</span>
    <span class="k">case</span> <span class="n">detail</span>
    <span class="k">case</span> <span class="n">tsunami</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ìœ„ ì˜ˆì‹œì˜ nested coding keys enumerationì€ case magnitude = â€œmagâ€ ê°’ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.<br />
place, time, code, detail, tsunamiëŠ” GeoJSON ê°ì²´ì—ì„œ ê°™ì€ ì´ë¦„ì„ í‚¤ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆê³ ,<br />
magnitudeëŠ” GeoJSON ê°ì²´ì—ì„œ â€œmagâ€ë¥¼ í‚¤ê°’ìœ¼ë¡œ ê°€ì§‘ë‹ˆë‹¤.</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nf">init</span><span class="p">(</span><span class="n">from</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">Decoder</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">values</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">container</span><span class="p">(</span><span class="nv">keyedBy</span><span class="p">:</span> <span class="kt">CodingKeys</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawMagnitude</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Double</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawPlace</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">place</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawTime</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Date</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">time</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawCode</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawDetail</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">URL</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">detail</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">rawTsunami</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">values</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">tsunami</span><span class="p">)</span>
        
        <span class="o">...</span> <span class="p">}</span>
</code></pre></div></div>
<p>ë””ì½”ë”©í•˜ëŠ” ìƒì„±ì í•¨ìˆ˜ì—ì„œ magnitudeë¥¼ í‚¤ê°’ìœ¼ë¡œ ì‚¬ìš©í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
CodingKeys enumì˜ ì¼€ì´ìŠ¤ ì´ë¦„ì€ Quake structì˜ í”„ë¡œí¼í‹°ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<br />
JSON ê°ì²´ì˜ í‚¤ ê°’ê³¼ ì´ë¦„ì´ ê°™ì€ ê²½ìš°ëŠ” case ì´ë¦„ë§Œ ì‘ì„± / ë‹¤ë¥¸ ê²½ìš°ëŠ” case magnitude = â€œmagâ€ì™€ ê°™ì´ ì‘ì„±í•©ë‹ˆë‹¤.</p>

<h1 id="existential-types">Existential Types</h1>
<blockquote>
  <p><a href="https://developer.apple.com/tutorials/app-dev-training/building-a-network-test-client">Building a network test client</a></p>
</blockquote>

<p>ì›ë˜ ì•±ì—ì„œëŠ” remote network serverì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë‘ë²ˆì§¸ ê²½ìš°ê°€ ìˆìŒ
Data Downloaderë¥¼ ê°ê° ë‹¤ë¥¸ ê²ƒì„ ì‚¬ìš©í•  ê²ƒì¸ë° ë‘ ë‹¤ìš´ë¡œë”ë¥¼ ì™„ì „íˆ ë”°ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼
existential typeì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•œ í•˜ë‚˜ì˜ ë‹¤ìš´ë¡œë”ë¥¼ ì‚¬ìš©í•  ê²ƒì„.</p>

<p>Existentnial typeì€ any í‚¤ì›Œë“œë¥¼ ì•ì— ë¶™ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ</p>

<p>lazyëŠ” letê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ. varì™€ í•¨ê»˜ ì‚¬ìš©.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">Foundation</span>

<span class="kd">class</span> <span class="kt">QuakeClient</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">feedURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson"</span><span class="p">)</span><span class="o">!</span>
    
    <span class="c1">//computed porpertyì˜ íƒ€ì…ì´ ìˆê³  millisecondsë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ ì´ë ‡ê²Œ ì‚¬ìš©í•œê±´ê°€?</span>
    <span class="c1">//date decoding strategyë¥¼ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œ anonymous í´ë¡œì €ë¥¼ ì‚¬ìš©í•´ì„œ init í•¨</span>
    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">aDecoder</span> <span class="o">=</span> <span class="kt">JSONDecoder</span><span class="p">()</span>
        <span class="n">aDecoder</span><span class="o">.</span><span class="n">dateDecodingStrategy</span> <span class="o">=</span> <span class="o">.</span><span class="n">millisecondsSince1970</span>
        <span class="k">return</span> <span class="n">aDecoder</span>
    <span class="p">}()</span>
    
    <span class="c1">//feedURLì€ ë¦¬í„°ëŸ´ ìŠ¤íŠ¸ë§ ê°’ì„ ê°€ì§€ê³  ìˆê³ , decoderëŠ” í´ë¡œì €ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë‹ˆì…œë¼ì´ì§•í•¨</span>
    <span class="c1">//downloader ì´ë‹ˆì…œë¼ì´ì§•í•˜ì—¬ ê°’ ì„¤ì •</span>
    <span class="c1">//Existential valueê°€ ì‚¬ìš©ë˜ëŠ” ë¶€ë¶„</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">downloader</span><span class="p">:</span> <span class="n">any</span> <span class="kt">HTTPDataDownloader</span>
    
    <span class="c1">//ì´ë‹ˆì…œë¼ì´ì§• ì¤‘ íŒŒë¼ë¯¸í„°ë¡œ í†µê³¼ëœ downloader(HTTPDataDownloader í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” any type)ê°€</span>
    <span class="c1">//QuakeClientì˜ downloaderë¡œ ì‚¬ìš©ë¨</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">downloader</span><span class="p">:</span> <span class="n">any</span> <span class="kt">HTTPDataDownloader</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">downloader</span> <span class="o">=</span> <span class="n">downloader</span>
    <span class="p">}</span>
    
    
<span class="p">}</span>
</code></pre></div></div>

<p>quakes ë°°ì—´ì„ ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ê³ , ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 
async, throws í‚¤ì›Œë“œë¥¼ ì‚¬ìš©. propertyì— asyncì™€ throwsë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ get syntaxë¥¼ ì‚¬ìš©í•´ì•¼ í•¨</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">quakes</span><span class="p">:</span> <span class="p">[</span><span class="kt">Quake</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">get</span> <span class="k">async</span> <span class="k">throws</span><span class="p">{</span>
        <span class="c1">//dataë¥¼ ì„œë²„ë¡œë¶€í„° ë‹¤ìš´ë¡œë“œ</span>
        <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="k">await</span> <span class="n">downloader</span><span class="o">.</span><span class="nf">httpData</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">feedURL</span><span class="p">)</span>
        <span class="c1">//ë‹¤ìš´ë¡œë“œí•œ ë°ì´í„°ë¥¼ ë””ì½”ë”©</span>
        <span class="k">let</span> <span class="nv">allQuakes</span> <span class="o">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="kt">GeoJSON</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="n">data</span><span class="p">)</span>
        <span class="c1">//GeoJSON ìŠ¤íŠ¸ëŸ­ì²˜ ì•ˆì— ì§€ì§„ ì •ë³´ë¥¼ ë°°ì—´ í˜•íƒœë¡œ ë‹´ëŠ” quakes</span>
        <span class="k">return</span> <span class="n">allQuakes</span><span class="o">.</span><span class="n">quakes</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>** URL ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° **</p>
<ol>
  <li>URLSessionì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œì¸ dataë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë ¤ê³  í•¨</li>
  <li>
    <p>ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œì¸ HTTPDataDownloaderë¥¼ ìƒì„±</p>

    <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">protocol</span> <span class="kt">HTTPDataDownloader</span> <span class="p">{</span>
 <span class="kd">func</span> <span class="nf">httpData</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">URL</span><span class="p">)</span> <span class="k">async</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">Data</span>
 <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>URLSessionì— extensionì„ ì‘ì„±í•˜ì—¬ ìœ„ ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œì„ ë”°ë¥´ë„ë¡ í•¨</li>
  <li>httpData(from:_) í•¨ìˆ˜ì˜ ë°”ë”” ë¶€ë¶„ì— ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ dataë¥¼ ì‚¬ìš©í•˜ì—¬ dataë¥¼ ê°€ì ¸ì˜´</li>
</ol>

:ET