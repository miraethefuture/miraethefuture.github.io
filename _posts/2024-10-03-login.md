---
title: ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°
author: Mirae
date: 2024-10-03
category: TIL 
layout: post
---

# êµ¬ê¸€ ë¡œê·¸ì¸ 

## í™˜ê²½ì„¤ì •

[ğŸ”— Get started with Google Sign-In for iOS and macOS](https://developers.google.com/identity/sign-in/ios/start-integrating)  

- CocoaPodsë‚˜ SPMìœ¼ë¡œ Google Sign-Inì„ í”„ë¡œì íŠ¸ì— ì¶”ê°€í•©ë‹ˆë‹¤.
- OAuth client IDë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
- OAuth server client IDë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì•±ë“¤ì€ ë¡œê·¸ì¸í•œ ìœ ì €ì˜ ì •ë³´ë¥¼ ë°±ì—”ë“œ ì„œë²„ë¡œ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ìœ ì €ì˜ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ë°±ì—”ë“œ ì„œë²„ë¡œ ë³´ë‚´ê¸° ìœ„í•´ ID tokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ìœ ì €ì˜ ID tokenì„ ë°›ê¸° ìœ„í•´ì„œëŠ” ì„œë²„ í´ë¼ì´ì–¸íŠ¸ IDì¸ ë‘ë²ˆì§¸ í´ë¼ì´ì–¸íŠ¸ IDê°€ í•„ìš”í•©ë‹ˆë‹¤. ì„œë²„ í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ì–»ê¸° ìœ„í•´ ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ íƒ€ì…ì˜ OAuth client IDë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
  
â¬†ï¸ ìœ— ë¶€ë¶„ê¹Œì§€ëŠ” ì§„í–‰ ì™„ë£Œ. (ì„œë²„ í´ë¼ì´ì–¸íŠ¸ IDëŠ” ë°±ì—”ë“œ ê°œë°œìë‹˜ê»˜ì„œ ìƒì„±í•´ì£¼ì‹¬)
  
### Xcode í”„ë¡œì íŠ¸ ì„¤ì •í•˜ê¸°

```swift
// OAuth client ID
<key>GIDClientID</key>
<string>YOUR_IOS_CLIENT_ID</string>

// OAuth server client ID
<key>GIDServerClientID</key>
<string>YOUR_SERVER_CLIENT_ID</string>

// Custom URL Scheme
<key>CFBundleURLTypes</key>
<array>
  <dict>
    <key>CFBundleURLSchemes</key>
    <array>
      <string>YOUR_DOT_REVERSED_IOS_CLIENT_ID</string>
    </array>
  </dict>
</array>
```
  
ìœ„ì™€ ê°™ì´ OAuth client ID / OAuth server client ID / Custom URL Schemeì„ ì„¤ì •í•©ë‹ˆë‹¤.  
(ë³´ì•ˆì„ ìœ„í•´ Config íŒŒì¼ì— ê°’ì„ ì €ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.)
  
## êµ¬í˜„

[ğŸ”— Integrating Google Sign-In into your iOS or macOS app](https://developers.google.com/identity/sign-in/ios/sign-in)  
[ğŸ”— Try iOS Sample App](https://developers.google.com/identity/sign-in/ios/sample-app)  

------------------------------------------------------ 

 
### 1. Handle the authentication redirect URL

AppDelegateì— ì•„ë˜ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ê³ , GIDSignInì˜ handle url ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
  
```swift
func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey : Any] = [:]) -> Bool {
    var handled: Bool
    handled = GIDSignIn.sharedInstance.handle(url)
    
    if handled {
        return true
    }
    // Handle other custom URL types.
    
    // If not handled by this app, return false.
    return false
}
```

### 2. Attempt to restore the user's sign-in state

ì•±ì´ ì‹œì‘ë  ë•Œ, restorePreviousSignInWithCallbackë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ë¯¸ êµ¬ê¸€ë¡œ ë¡œê·¸ì¸ì„ í–ˆë˜ ì‚¬ìš©ìì˜ sign-in ìƒíƒœë¥¼ ë³µêµ¬í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ ìƒíƒœê°€ ë³µêµ¬ë˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ ì•±ì„ ì‚¬ìš©í• ë•Œë§ˆë‹¤ ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. (ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒí•˜ì§€ ì•Šì•˜ë‹¤ë©´)  
  
<b>application(application:didFinishLaunchingWithOptions:)</b>ì—ì„œ <b>restorePreviousSignIn</b>ì˜ ê²°ê³¼ê°’ì„ ì‚¬ìš©í•˜ì—¬, ì²˜ìŒ ì•±ì´ ì—´ë ¸ì„ ë•Œ ì–´ë–¤ ë·°ë¥¼ ë³´ì—¬ì¤„ì§€ ê²°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

```swift
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
    // Override point for customization after application launch.
    GIDSignIn.sharedInstance.restorePreviousSignIn { user, error in
        if error != nil || user == nil {
            // Show the app's signed-out state.
        } else {
            // Show the app's signed-in state.
        }
    }
    return true
}
```
### !
- KeychainSwift ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ accessTokenì„ í‚¤ì²´ì¸ì— ì €ì¥í•˜ëŠ” ë¡œì§ì„ ì‘ì„±í•˜ì˜€ë‹¤. UserDefaults ë³´ë‹¤ ë³´ì•ˆìƒ ì•ˆì „í•  ê²ƒ ê°™ë‹¤ê³  íŒë‹¨í•˜ì˜€ê¸° ë•Œë¬¸ì´ë‹¤.  
- í‚¤ì²´ì¸ì— ì €ì¥í•œ í† í°ì„, ë¡œê·¸ì¸ì´ í•„ìš”í•œ APIì™€ í†µì‹  ì‹œ headerì— í• ë‹¹ë˜ë„ë¡ í•˜ì˜€ë‹¤.
- ë¡œê·¸ì¸ì— ì„±ê³µí•˜ê³  accessTokenì„ ì–»ê²Œ ë˜ë©´, ë¡œê·¸ì¸ stateë¥¼ ë³€ê²½í•˜ê³  stateì— ë”°ë¼ ë¡œê·¸ì¸/ë¹„ë¡œê·¸ì¸ í™”ë©´ì„ ë³´ì—¬ì£¼ì–´ì•¼ í•œë‹¤. 
  


