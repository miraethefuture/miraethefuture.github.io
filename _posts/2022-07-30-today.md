---
title: iOS 개발 튜토리얼 / UIKit essentials / 앱 Today
author: Mirae
date: 2022-07-30
category: TIL
layout: post
cover: /assets/images/team.gif
---

[iOS App Dev Tutorials: UIKit Essential](https://developer.apple.com/tutorials/app-dev-training/getting-started-with-today)  
위 공식 UIKit 개발 튜토리얼을 따라가며 그 과정을 정리해 봅니다.

# Creating a List View  

  이 부분에서는 앱의 root view를 생성합니다. 리스트 레이아웃의 콜렉션 뷰로 사용자의 데일리 리마인더를 화면에 보여줍니다. 리스트를 보여줄 콜렉션 뷰를 생성하고 content configuration object를 사용하여 셀들의 외형을 정합니다. 그리고 그 셀들을 diffable 데이터 소스에 연결하여 데이터가 변경될 때 사용자의 인터페이스도 함께 변경되도록 합니다. 
  
## Section 1 - Create a Project  
  
  이 모듈의 전체 과정을 거쳐 앱을 만들어가며 앱 개발의 가장 중요한 부분들을 배울 것입니다. Xcode와 UIKit을 사용하는 일반적인 프로그래밍 패턴에 대해 알아볼 것입니다. 먼저, Xcode 템플릿을 사용여 iOS 앱 프로젝트를 생성해 봅니다.  
  (프로젝트 생성과 시뮬레이터 사용에 대해서는 알고 있기 때문에 스킵합니다.)
  
## Section 2 - Add a Collection View Controller
    
  뷰 컨트롤러를 스토리보드에 추가함으로써 앱 Today 만들기를 시작합니다. 뷰 컨트롤러는 데이터 모델과 뷰 사이에서 다리 역할을 합니다. 각 컨트롤러는 뷰 계층을 관리하고, 뷰의 컨텐츠를 업데이트하고, UI의 이벤트에 응답합니다.  
  콜렉션 뷰를 생성하기 위해 Interface Builder를 사용할 것입니다. 콜렉션 뷰는 그리드, 컬럼, 로우, 테이블의 형태로 셀을 나타낼 수 있습니다.  
    
- Step 1  
  Main 스토리보드에 프로젝트 생성 시 자동으로 생성되어 있는 View Controller Scene을 삭제해줍니다. (선택 후 키보드 delete ⌫ 키 누르기) 이 뷰 컨트롤러를 리스트를 보여 줄 뷰 컨트롤러로 대체 할 것입니다.  
    
- Step 2  
  오른쪽 위에 + 아이콘(라이브러리 아이콘)을 클릭한 뒤 Collection View Controller를 검색합니다. 
    
- Step 3  
  콜렉션 뷰 컨트롤러를 캔바스로 드래그하여 새로운 콜렉션 뷰를 생성합니다.  
    
- Step 4
  Attributes inspector에서 Is initial View Controller 체크박스를 선택하여 해당 Scene을 스토리보드 엔트리 포인트로 설정합니다. initial view controller 값은 앱이 스토리보드를 로드할 때 어떤 뷰 컨트롤러가 로드될 지 결정합니다.  
 NOTE: 앱은 여러개의 스토리보드를 가질 수 있습니다. 앱의 프로젝트 파일 안에 있는 Main Interface setting은 어떤 스토리보드가 앱이 처음 실행되었을 때 로드될 지 결정합니다. 
 
 (Step 5 생략)
 
 여기까지 콜렉션 뷰 컨트롤러를 생성하고 initial view로 설정하였습니다. 다음으로는, 리마인더를 담을 데이터 모델을 생성하여 데이터 설정을 해보도록 하겠습니다.  
   
## Section 3 - Create a Reminder Model  

   앱 Today는 MVC(모델-뷰-컨트롤러) 구조 패턴을 사용할 것입니다. UIKit 앱에서 주로 사용되는 패턴입니다. 뷰 객체는 데이터가 나타나는 모습에 대한 것을 제공합니다. 모델 객체는 앱의 데이터와 비즈니스 로직을 관리합니다.  
   위에서 생성한 뷰 컨트롤러는 모델이 직접적으로 뷰를 변경시키거나, 뷰가 직접적으로 모델에 영향을 끼치지 않도록 합니다. 이제 데이터 모델을 생성하여 리스트의 리마인더를 보여줄 것입니다.  
   
- Step 1  
  Xcode의 왼쪽에 있는 프로젝트 네비게이터에서 Models라는 새 그룹을 생성합니다. (프로젝트 네비게이터 아래 부분에 있는 + 버튼 클릭 → New Group)  

- Step 2  
  Models에 Reminder.swift 라는 새 파일을 생성하고 struct Reminder를 생성합니다.  
  
  ```swift 
  import Foundation
  
  struct Reminder {
      var title: String
      var dueDate: Date
      var notes: String? = nil
      var isComplete: Bool = false
  }
  
  #if DEBUG
  extension Reminder {
  }
  #endif
  ```
- Step 3  
  title, dueDate 속성을 선언합니다.

- Step 4. 
  옵셔널 스트링 속성인 notes를 선언하고 기본값으로 nil을 줍니다.

- Step 5  
  불리언 타입의 속성 isComplete을 선언하고 기본 값으로 false를 줍니다. 

- Step 6  
  파일의 아래 부분에 샘플 데이터를 담을 extension을 추가합니다. 그리고 #if. DEBUG 블락안에 extexsion을 위치시킵니다.  

- #If DEBUG flag 는 compilation directive인데 이 플래그로 감싼 코드는 출시된 앱을 빌드할 때 컴파일되지 않습니다. 디버그 빌드 시 코드를 테스트하기 위해 사용하거나 샘플 테스트 데이터를 제공하기 위해 사용할 수 있습니다. 이 단계에서는 샘플 데이터를 제공하기 위해 사용합니다. 

- Step 7
  샘플 리마인더 정보를 가진 static 배열을 정의합니다.
  
  ```swift 
  import Foundation
  
  struct Reminder {
      var title: String
      var dueDate: Date
      var notes: String? = nil
      var isComplete: Bool = false
  }
  
  #if DEBUG
  extension Reminder {
      static var sampleData = [
        Reminder(title: "예약한 책 확인하기", dueDate: Date().addingTimeInterval(800.0), notes: "전자 도서관 앱에서 확인하기"),
        Reminder(title: "도시락 구입하기", dueDate: Date().addingTimeInterval(14000.0), notes: "B마트 쿠폰 확인하기", isComplete: true),
        Reminder(title: "선인장 물주기", dueDate: Date().addingTimeInterval(24000.0), notes: "물주고 통풍 신경쓰기"),
        Reminder(title: "블로그 글 정리하기", dueDate: Date().addingTimeInterval(60000.0), notes: "조금이라도 하기"),
        Reminder(title: "요가 일주일 테스트 신청", dueDate: Date().addingTimeInterval(72000.0), notes: "요일도 생각해보기"),
        Reminder(title: "보고 피피티 끝내기", dueDate: Date().addingTimeInterval(3200.0), notes: "너무 늦지 않게 끝내기")
    ]
  }
  #endif
  ```  
  
> ##### addingTimeInterval(\_:)
>
> 특정 시간만큼의 간격을 더하여 새로운 날짜 값을 생성합니다. 패러미터 값으로는 초(seconds)를 사용합니다. 
{: .block-tip }
  
여기까지, 프로젝트와 스토리보드를 설정하고 데이타 스트럭쳐를 생성하였습니다. 이제부터는 콜렉션 뷰의 컴포넌트에 대해 알아보며 콜렉션 뷰의 외형에 대해 알아보겠습니다. 

## Section 4 - Configure the Collection as a List  
  
  컴포지셔널 레이아웃을 사용하여 콜렉션 뷰 설정을 시작합니다. 컴포지셔널 레이아웃은 섹션, 그룹, 아이템이라는 컴포넌트들을 결합하여 뷰를 그립니다. 섹션은 아이템들을 가지고 있는 그룹을 담고 있는 컨테이너 뷰를 화면에 보여줍니다. 
  스토리 보드의 콜렉션 뷰 컨트롤러를 backing code에 연결하며 시작해 봅니다.  
  
- Step 1  
  프로젝트 생성 시 자동으로 생성되었던 ViewController.swift 파일에 있는 클래스  ViewController의 이름을 컨트롤 + 클릭합니다. Refactor > Rename 하여 클래스의 이름을 ReminderListViewController로 변경합니다. 그리고 슈퍼 클래스를 UIViewController에서 UICollectionViewControllerfh 로 변경합니다. 
  
  - Step 2  
    Main.storyboard를 열고 오른쪽의 inspector 중 Identity inspector에서 Custom Class - Class를 ReminderListViewController로 변경합니다. 
    뷰 컨트롤러의 indentity를 변경해줌으로써, ReminderListViewController의 속성과 메서드에 접근 권한을 얻습니다. 
      
    앱 Today는 리스트의 형태로 리마인더를 보여줍니다. 미리 정의되어 있는 배치(Configuration)를 사용하여 리스트의 외형을 정의해 봅시다. 
    
- Step 3
  ReminderListViewController.swift 안에 listLayout()이라는 function을 생성합니다. 새 리스트의 외형을 담을 변수를 grouped appearance를 사용하여 생성합니다. 
  
  ```swift
  func listLayout() -> UICollectionViewCompositionalLayout {
    var listConfiguration = UICollectionLayoutListConfiguration(appearance: .grouped)
    listConfiguration.showsSeparators = false
    listConfiguration.backgroundColor = .clear
    return UICollectionViewCompositionalLayout.list(using: listConfiguration
  }
  ```
  UICollectionLayoutListConfiguration는 리스트 레이아웃 형태의 섹션을 생성합니다. 
  
- Step 4  
  구분선이 나타나지 않도록 하고 배경색을 .clear로 설정합니다. 

- Step 5 
  리스트 형태의 컴포지셔널 레이아웃을 리턴합니다.
  
- Step 6 
  ViewDidLoad() 메서드 안에 새 리스트 레이아웃을 생성합니다.  
  
  뷰 컨트롤러가 자신의 뷰 계층 구조를 메모리에 로드한 뒤 시스템이 viewDidLoad()를 호출합니다.
  
  ```swift 
      override func viewDidLoad() {
        super.viewDidLoad()
        
        let listLayout = listLayout()
        collectionView.collectionViewLayout = listLayout
        
        // collectionView는 현재 뷰 컨트롤러가 관리하는 콜렉션뷰 객체
    }
  ```
- Step 7 
  listLayout을 콜렉션 뷰 레이아웃에 할당합니다.

## Section 5 -  Configure the Data Source 
<!--데이터 소스를 컨피규어 한다라...-->
  컴포지셔널 레이아웃을 사용하여 콜렉션 뷰에 리스트 섹션을 생성했습니다.  
  콜렉션 뷰에 셀을 등록하고 content configuration을 사용하여 셀의 모양을 정의할 것입니다. 그리고나서 데이터 소스와 셀을 연결합니다. 데이터가 변경될 때마다 사용자 인터페이스를 업데이트하고 움직임을 줄 diffable 데이타 소스를 사용할 것입니다. 
<!--셀을 register 한다라...셀을 등록한다..?-->

- Step 1  
  새로운 cell registration을 생성합니다.  
  Cell Registration은 셀의 속성(내용과 모양)을 구성하는 방법을 지정해 줍니다. 
  
    ```swift 
      override func viewDidLoad() {
        super.viewDidLoad()
        
        let listLayout = listLayout()
        collectionView.collectionViewLayout = listLayout
        
        // collectionView는 현재 뷰 컨트롤러가 관리하는 콜렉션뷰 객체
        
        let cellRegistration = UICollectionView.CellRegistration { (cell: UICollectionViewListCell, indexPath: IndexPath, itemIdentifier: String) in 
            let reminder = Reminder.sampleData[indexPath.item]
            var contentConfiguration = cell.defaultContentConfiguration()
            contentConfiguration.text = reminder.title cell.contentConfiguration = contentConfiguration
}
    }
  ```

- Step 2
  item에 연결된 리마인더를 가져옵니다. 

- Step 3 
  셀의 default content configuration을 가져옵니다. defaultContentConfiguration() 메서드는 미리 정의되어 있는 시스템 스타일을 생성합니다.
  - Step 4  
    샘플 데이터인 reminder의 타이틀을 content configuration에 할당합니다.  
    리스트는 configuration 텍스트를 셀의 프라이머리 텍스트로 보여줍니다. 
    
- Step 5
  설정한 content configuration을 셀에 할당합니다. 
    
  여기 까지 셀의 내용과 모양을 설정했습니다. 이제부터는 diffable data 소스에 셀을 연결해 봅시다.  
    


